<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flappy Bird</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #70c5ce;
            font-family: Arial, sans-serif;
        }
        canvas {
            border: 2px solid #000;
            background-image: url('bg.png'); /* Changed to PNG */
            background-size: cover;
            max-width: 100%;
            height: auto;
        }
        #score {
            position: absolute;
            top: 10px;
            left: 10px;
            font-size: 24px;
            color: white;
        }
        #gameOver {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            color: black; /* Changed to black */
            font-size: 32px;
        }
        #gameOver img {
            width: 200px; /* Adjust size as needed */
            height: auto;
            margin-bottom: 20px;
        }
        #gameWin {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            color: black; /* Changed to black */
            font-size: 32px;
            background-color: rgba(255, 255, 255, 0.9); /* Added semi-transparent background for popup effect */
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        }
        #gameWin video {
            width: 300px; /* Reduced size for popup */
            height: auto;
            margin-bottom: 20px;
        }
        button {
            margin-top: 20px;
            padding: 10px 20px;
            font-size: 18px;
        }
    </style>
</head>
<body>
    <div id="score">Score: 0</div>
    <canvas id="gameCanvas" width="400" height="600"></canvas>
    <div id="gameOver">
        <img src="collapse.jpg" alt="Game Over Image"> <!-- Changed to JPG -->
        GAY'M OVER<br>
        <button onclick="restartGame()">Restart</button>
    </div>
    <div id="gameWin">
        <video id="winVideo" controls>
            <source src="end.mp4" type="video/mp4">
            Your browser does not support the video tag.
        </video>
        congratulation nigga<br>
        <button onclick="restartGame()">Restart</button>
    </div>
    <audio id="bgMusic" loop>
        <source src="bgmusic.mp3" type="audio/mpeg">
    </audio>
    <audio id="gameOverSound">
        <source src="gameover.mp3" type="audio/mpeg">
    </audio>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreDisplay = document.getElementById('score');
        const gameOverDiv = document.getElementById('gameOver');
        const gameWinDiv = document.getElementById('gameWin');
        const winVideo = document.getElementById('winVideo');
        const bgMusic = document.getElementById('bgMusic');
        const gameOverSound = document.getElementById('gameOverSound');

        // Load images
        const birdImg = new Image();
        birdImg.src = 'bird.png'; // Remains PNG
        const pipeImg = new Image();
        pipeImg.src = 'pipe.jpg'; // Changed to JPG

        // Game variables (physics constants kept fixed for consistent gameplay)
        let bird = { x: 50, y: 300, width: 34, height: 24, velocity: 0 };
        let gravity = 0.1; // Fixed
        let jump = -3; // Fixed
        let pipes = [];
        let pipeWidth = 70;
        let pipeGap = 170;
        let pipeSpeed = 0.8; // Fixed
        let score = 0;
        let gameRunning = true;

        // Resize canvas for mobile (scale visuals only)
        function resizeCanvas() {
            const aspectRatio = 400 / 600;
            const maxWidth = Math.min(window.innerWidth - 20, 400);
            const maxHeight = Math.min(window.innerHeight - 20, 600);
            if (maxWidth / maxHeight > aspectRatio) {
                canvas.width = maxHeight * aspectRatio;
                canvas.height = maxHeight;
            } else {
                canvas.width = maxWidth;
                canvas.height = maxWidth / aspectRatio;
            }
            // Scale visual elements proportionally, but keep physics fixed
            const scale = canvas.width / 400;
            bird.width = 34 * scale;
            bird.height = 24 * scale;
            pipeWidth = 70 * scale;
            pipeGap = 170 * scale;
            // Reset bird position to center on resize
            bird.y = canvas.height / 2;
        }
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas(); // Initial resize

        // Bird draw function
        function drawBird() {
            ctx.drawImage(birdImg, bird.x, bird.y, bird.width, bird.height);
        }

        // Pipe draw function
        function drawPipes() {
            pipes.forEach(pipe => {
                // Top pipe
                ctx.drawImage(pipeImg, pipe.x, pipe.topY, pipeWidth, pipe.topHeight);
                // Bottom pipe (flip if needed, but assuming pipe.jpg is for bottom)
                ctx.save();
                ctx.translate(pipe.x + pipeWidth / 2, pipe.bottomY + pipe.bottomHeight / 2);
                ctx.rotate(Math.PI);
                ctx.drawImage(pipeImg, -pipeWidth / 2, -pipe.bottomHeight / 2, pipeWidth, pipe.bottomHeight);
                ctx.restore();
            });
        }

        // Update game state
        function update() {
            if (!gameRunning) return;

            // Bird physics (fixed constants)
            bird.velocity += gravity;
            bird.y += bird.velocity;

            // Add pipes
            if (pipes.length === 0 || pipes[pipes.length - 1].x < canvas.width - 200) {
                let topHeight = Math.random() * (canvas.height - pipeGap - 100) + 50;
                pipes.push({
                    x: canvas.width,
                    topY: 0,
                    topHeight: topHeight,
                    bottomY: topHeight + pipeGap,
                    bottomHeight: canvas.height - (topHeight + pipeGap)
                });
            }

            // Move pipes (fixed speed)
            pipes.forEach(pipe => {
                pipe.x -= pipeSpeed;
            });

            // Remove off-screen pipes
            pipes = pipes.filter(pipe => pipe.x + pipeWidth > 0);

            // Collision detection
            if (bird.y + bird.height >= canvas.height || bird.y <= 0) {
                gameOver();
            }
            pipes.forEach(pipe => {
                if (bird.x < pipe.x + pipeWidth && bird.x + bird.width > pipe.x &&
                    (bird.y < pipe.topHeight || bird.y + bird.height > pipe.bottomY)) {
                    gameOver();
                }
                // Score
                if (pipe.x + pipeWidth < bird.x && !pipe.scored) {
                    score++;
                    pipe.scored = true;
                    scoreDisplay.textContent = 'Score: ' + score;
                    if (score >= 30) {
                        gameWin();
                    }
                }
            });
        }

        // Draw everything
        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawPipes();
            drawBird();
        }

        // Game loop
        function gameLoop() {
            update();
            draw();
            requestAnimationFrame(gameLoop);
        }

        // Jump on click or space/touch
        canvas.addEventListener('click', () => {
            if (gameRunning) {
                bird.velocity = jump;
            }
        });
        canvas.addEventListener('touchstart', (e) => {
            e.preventDefault();
            if (gameRunning) {
                bird.velocity = jump;
            }
        });
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space' && gameRunning) {
                e.preventDefault();
                bird.velocity = jump;
            }
        });

        // Game over
        function gameOver() {
            gameRunning = false;
            gameOverDiv.style.display = 'block';
            bgMusic.pause();
            gameOverSound.play();
        }

        // Game win
        function gameWin() {
            gameRunning = false;
            gameWinDiv.style.display = 'block';
            winVideo.play();
            bgMusic.pause();
        }

        // Restart
        function restartGame() {
            bird.y = canvas.height / 2;
            bird.velocity = 0;
            pipes = [];
            score = 0;
            scoreDisplay.textContent = 'Score: 0';
            gameRunning = true;
            gameOverDiv.style.display = 'none';
            gameWinDiv.style.display = 'none';
            winVideo.pause();
            winVideo.currentTime = 0;
            bgMusic.play();
        }

        // Start music and game
        bgMusic.play();
        gameLoop();
    </script>
</body>
</html>
